import{$ as o}from"./app-19c9d067.js";import{R as _,w as l}from"./svelte-range-slider-pips-4da35622.js";import"./jquery-5c3435d1.js";const b=[".filter-item--type-custom .checkbox-preview",".filter-item--brands .checkbox-preview",".filter-item--colors .colors-wrapper",".filter-item--countries .custom-control"];function A(){const t=o("#currency-first-main"),e=o("#currency-last-main");new _({target:o("#price-slider")[0],props:{min:parseFloat(t.attr("min")),max:parseFloat(e.attr("max")),values:[t.val()?t.val():t.attr("min"),e.val()?e.val():e.attr("max")],step:1,range:!0,float:!0,suffix:" "+store.base_currency_name_short}}).$on("change",function(a){t.val(a.detail.values[0]).trigger("change"),e.val(a.detail.values[1]).trigger("change")});const r=o("#filter-left-form"),n=o("#filter-full-form");r.submit(function(a){a.preventDefault()}),n.submit(function(a){a.preventDefault()}),o(".filter-submit-main").click(function(a){a.preventDefault(),u(r)}),o(".filter-submit-full").click(function(a){a.preventDefault(),u(n)}),o(".filter-reset").click(function(a){a.preventDefault(),w()}),o(".filter-delete").click(function(a){if(a.preventDefault(),o(this).attr("id").split("=").length<2)throw new Error("[form-submit] error: incorrect filter name-value pair!");const c=o(this).attr("id").split("=")[0],p=o(this).attr("id").split("=")[1];D(c,p)}),o(".sort-by-option").click(function(a){a.preventDefault();const c=o(this).attr("id");s("sort_by",c)}),o("#show-24-items-per-page").click(function(a){a.preventDefault(),s("per_page",24)}),o("#show-36-items-per-page").click(function(a){a.preventDefault(),s("per_page",36)}),o("#show-48-items-per-page").click(function(a){a.preventDefault(),s("per_page",48)}),o(".input-search").on("keypress",function(a){a.which===13&&u(n)}),b.forEach(function(a){o(a).on("shown.bs.tooltip",function(c){const p=o(c.target).attr("aria-describedby");if(o("#"+p).find(".filter-find").length){const h=y(r);o.ajax({url:catalog.products_count_by_filter_endpoint+"/"+h,success:function(g){o("#products-count").html(g.data.count)}}),o("#"+p+" .filter-submit-main").click(function(g){g.preventDefault(),u(r)})}})}),o(l).on("changePage",function(a,c){a.preventDefault(),s("page",c)})}function m(){const t="filter";let e="";l.location.pathname.indexOf(t)!==-1&&(e=l.location.pathname.split(t)[1].replace("/",""));let i=[];return e&&e!==""&&e.split(";").forEach(function(r){i[r.split("=")[0]]=r.split("=")[1].indexOf(",")!==-1?r.split("=")[1].split(","):r.split("=")[1]}),i}function f(t){let e=[];Object.keys(t).forEach(r=>{Array.isArray(t[r])&&(t[r]=t[r].join()),t[r]&&e.push(`${r}=${t[r]}`)});const i=catalog.category_slug?catalog.category_slug:catalog.product_type_slug;return e.length===0?l.location.pathname.split(i)[0]+i:l.location.pathname.split(i)[0]+i+"/filter/"+e.join(";")}function v(){const t=catalog.category_slug?catalog.category_slug:catalog.product_type_slug;return l.location.pathname.split(t)[0]+t}function d(t){if(!catalog.product_type_slug)throw new Error("[FilterSubmit] error: product slug is undefined! Catalog filters are broken!");const e=new FormData(t[0]);let i=[];for(const n of e.entries())if(i[n[0]]){if(n[0]==="price_from"||n[0]==="price_to"){i[n[0]]=n[1];continue}i[n[0]]=i[n[0]]+","+n[1]}else i[n[0]]=n[1];let r=m();return"sort_by"in r&&(i.sort_by=r.sort_by),"per_page"in r&&(i.per_page=r.per_page),i}function y(t){const e=d(t);let i=[];return Object.keys(e).forEach(r=>{Array.isArray(e[r])&&(e[r]=e[r].join()),e[r]&&i.push(`${r}=${e[r]}`)}),i.join(";")}function u(t){const e=d(t);l.location.href=f(e)}function w(){let t=m(),e=[];"sort_by"in t&&(e.sort_by=t.sort_by),"per_page"in t&&(e.per_page=t.per_page),e.length?l.location.href=f(e):l.location.href=v()}function s(t,e){let i=m();i[t]=e,t==="per_page"&&delete i.page,console.log("44444"),console.log("buildLinkWithParams "+f(i)),l.location.href=f(i)}function D(t,e){let i=m();Object.keys(i).forEach(r=>{if(r===t)if(Array.isArray(i[r])){const n=i[r].indexOf(e);n!==-1&&i[r].splice(n,1)}else delete i[r]}),l.location.href=f(i)}export{A as init};
